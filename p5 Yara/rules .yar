
rule Elf: practicaYARA_A
{
meta:
	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
   	$a = {7f 45 4c 46}
condition:
	$a at 0
}

rule PE: practicaYARA_B
{
meta:
    	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
	$a = {4d 5a}
condition:
	$a at 0
}

rule BigElf: practicaYARA_C
{
meta:
    	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"

condition:
	Elf and filesize > 500KB
}

rule GPL: practicaYARA_D
{
meta:
    	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
   	$a="GNU GPL version 3 or later"
    	$b="GNU GPL version 2 or later"
condition:
	Elf and ($a or $b)
}

rule Bin: practicaYARA_E
{
meta:
    	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
	$a={38 45 1e a5 99 ee ?? ?? ?? ?? 59 c4 c3 0a f2 88}
condition:
    	$a 
}

rule Indentation: practicaYARA_F
{
meta:
    	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
	$a = "program indentation level too deep"nocase

condition:
	Elf and filesize > 50KB and $a
}
rule BinOff: practicaYARA_G
{
meta:
    	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
	$a = {6d c8 7a 4e ad ca 07 c3}

condition:
	$a in(0xb7b0..0xb970)
}
rule Integer: practicaYARA_H
{
meta:
   	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
    	$a={a8 d8 01}
    	$b={aa d8 01}
    	$c={85 49 00}
condition:
	Elf and 2 of ($*) and filesize < 20KB 
      
}

rule Regex: practicaYARA_I
{
meta:
 	authorname="Javier Burgos Chamorro"
	authomail="j.burgos.2018@alumnos.urjc.es"
strings:
 	$a=/(USER\W+PID\W+%CPU\W+%MEM\W+VSZ\W+RSS\W+TTY\W+STAT\W+START\W+TIME\W+COMMAND)/
 	$b=/(root.+1[0-9]{3}.+(\[lockd\]))/
 	$c=/(gdm+.+\n)/
 condition:
 	not(Elf or PE) and $a and $b and #c > 20
 }

